## 概要
SREってなんだ？

具体的にはどういったことしていくの？

## SREとは
信頼性の高い本番環境システムを実行指定行くための、職務・マインドセット・エンジニアリング手法のまとめ

現代は変化が早いため、サービスの開発とリリースにも速度が求められる。しかし、開発を高速で行うとサービスの信頼性に影響が出る。そこで、信頼性の確保をしつつ開発運用をしていくための考え方。



### メリット
開発からリリースまでの高速化

SREの原則に従って、問題解決の高速化と信頼性の向上

### DevOpsとの違いは？
SREを実践していくと、効率的なDevOpsに繋がる

DevOps自体は開発からリリース、運用まで一貫してやっていくという概念。

「SREはDevOpsの概念の実装」とはよく言われている。

DevOpsのポイント
- 組織のサイトの削減
- エラー発生を前提とする
- 段階的に変更を行う
- ツールと自動化を活用する
- 全てを計測する

### Plafrorm Engineeringとの違いは？
目的の違い
- Plafrorm Engineering：開発者の生産性を高めるプラットフォームを設計・構築・運用することに注力。CI/CDの設定、コンテナオーケストレーションツールの管理、開発環境の最適化が主要な業務。
- SRE：サービスの信頼性と可用性に注力。運用に特化し、監視、アラート、インシデント対応、キャパシティプランニングが主な業務範囲

両方とも、システムと開発プロセスの効率と信頼性向上に貢献

SREはシステムに、Platform Engineeringは開発者に注目する

まぁ、あんまり気にしなくていいかもね

### 個人的なイメージ
今までのシステム開発だと、以下のようにチームが分かれていることが多い。
- ビジネスチーム
- 開発チーム
- インフラチーム
- 運用チーム

チームが分かれることによって、組織のサイロ化が発生してしまう。
これを超えていこうというのが、「アジャイル」や「DevOps」になり、より効率的に組織運営をしていくことに繋がる。

上記のうち、SREは全部横断で見ていくのが理想かな？

１つのチームの中に、上記のチームの人員が混じっているのが理想だね。

### SREの種類
- Platform SRE：アプリチームに対して、インフラサービスの構築や改善を支援
- Emvedded SRE：アプリチームに参画してリリースエンジニアリングを主導する

別の言い方と、具体的なやること
- 外交官(Diplomat)チーム：モニタリングのダッシュボード構築、SLI/SLOの策定管理更新、CI/CDの設計構築
- 保安官(Sheriff)チーム：リリース方式の作成/導入、障害訓練の企画/遂行、ワークロードの脆弱性検知
- 全体で担当：モニタリングと予兆監視、オンコール対応、トイルの削減

## 具体的にやること
- サービスのモニタリングの組み込み
- SLI指標の選択
  - Service Level Indicatorで、何でどう測るかを定義する。
  - SLIの例：リクエストのレイテンシ、エラー率、システムスループット、可用性
- SLOの設定
  - Service Level Objectiveで、SLIの指標を達成するための具体的な目標。
  - SLIで計測される指標の目標値の範囲
- エラーバジェットの追跡
  - エラー予算に当たり、SLOを下回った場合は信頼性回復のためにエラー修正や安定性向上などをしていく必要がある。逆にエラーバジェットに余裕があるなら積極的にリリースなどを行うべき
- 指標やログの集約と可視化
- MTTR（平均修理時間）の短縮
- インシデントの迅速な解決
    - 明文化された手順と役割の設定
    - コミュニケーションの場の設定
- CI/CDの構築
- 変更の安全なロールバック
- ログ・イベント・指標・SLOをまとめたビューの構築
- リアルタイムログ管理と大規模分析
- トイルの削減
    - トイルとは以下のうち１つでも当てはまるもの
        - 手作業であること
        - 繰り返させること
        - 自動化できること
        - 戦術的であること
        - 長期的な価値を持たないこと
        - サービスの成長に対して正比例であること
- ポストモーテムの作成
  - ポストモーテムとは、インシデントの事後分析。根本原因の把握と再発防止策の作成を通して、システムやプロセスの改善を行う。
  - インシデントは起こるものなので、いかに再発を防止しつつ、より良いサービスにしていくかを考えるもの
  - ポイント
      - 作成する条件をあらかじめ決めること
      - 批判や非難を行わず、建設的であり続ける
      - ポシとモーテムをレビューし共有する
      - ポストモーテム文化の確立
    - 含むべき内容
        - 題名、作成日、作者、ステータス、サマリ、インパクト、根本原因、発生要因、対応、検出、アクションアイテム（再発防止策、種類、担当者名、バグの種類）、教訓（うまくいったこと、うまくいかなかったこと、幸運だったこと）、タイムライン、参考情報
- 障害訓練
- 脆弱性検知
- 各チームへのSREの注入
- 改善のためのバックログの作成と棚卸し会議
- モニタリング：システムに関するリアルタイムのデータ収集・処理・集計・表示
    - 種類
        - ホワイトボックスモニタリング：システム内部で公開されているメトリクスに基づくモニタリング
        - ブラックボックスモニタリング：ユーザーが目にする挙動のテスト
        - ダッシュボード：サービスの主要メトリクスをサマリ表示するアプリケーション
    - モニタリング出力
        - アラート；即座にアクションが必要
        - チケット：あとでアクションが必要
        - ロギング：アクション不要だが、ログ取得するための通知
- リリースエンジニアリング：リリースを信頼できるようにする
    - セルフサービスモデル
    - 拘束性
    - 密封ビルド
    - ポリシーと手順の強制
- プロダクションミーティングの実施
    - 毎週ぐらいで、SREチームと他の関連する参加者で実施
    - 目的は、「サービスの状況を明確に説明し、関係者の認識を高め、サービスの運用を改善する」
    - サービス運用パフォーマンスの詳細について話し合い、設計や実装に関連づけて問題解決を行う。

より細かいこと
- IaCの適用
- コンテナへの移行
- サーバレス化
- クエリ修正
- Datadogによる監視モニタリング
- 障害対応フローの構築
- データのバックアップ
- 管理モニタリング改善


## SREのアプローチ方法
1. SREチームを組織する
1. SLIを計測し、SLOを設定する
1. トイルの削減のために、プログラムを書いて自動化・省力化を行う
1. 運用の改善
    - モニタリングの改善：アラート・チケット・ロギングの分類
    - 緊急対応時の手順作成
    - 変更管理：ロールアウトの実装、高速かつ正確な問題の検出、安全なロールバック
1. キャパシティプランニング・効率的なリソース活用
1. ポストモーテム

## 参考URL
- https://ascii.jp/elem/000/004/103/4103386/
- SREとはなにか [サイト リライアビリティ エンジニアリング]　https://sreake.com/blog/what-is-sre/
- https://sreake.com/blog/3-diffs-with-sre-and-platform-engineer/

まだ見てない
- https://static.googleusercontent.com/media/sre.google/ja//static/pdf/jp-enterprise-roadmap-to-sre.pdf
