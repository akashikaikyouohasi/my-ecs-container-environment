## 概要
監視について記載する

### 扱うべき内容
- メトリクス
- ログ
- アラート
- オンコール
- 障害管理
- 振り返り
- 統計

## 監視とは
```
Pvii
あるシステムやそのシステムのコンポーネントの振る舞いや出力を観察しチェックし続ける行為
```

### 監視アンチパターン(1章)
アンチパターン：一見良いアイディアだが実装すると手痛いしっぺ返しをくらうもお
- ツール依存
    - 手段の目的化するなということ。監視は単一の問題ではないため。
    - ツールを使うなというわけではない
    - コードレベルで監視できるAPMや、クラウドインフラのパフォーマンス監視にモダンなサーバ監視ソリューリョンや、ネットワーク専門の監視ツールなど、汎用的なツールと専門化されたツールを組み合わせればい(P5)
    - ただし、ツールによって成功はしない。ツールは道具なので、不断の試行錯誤が必要
    - 監視は複雑なので、1つのツールやダッシュボードに詰め込むのは効率が悪いよ
- 役割としての監視
    - 監視は役割ではなくスキルなので、チーム全員がある程度のレベルでいる必要がある。全員が本番環境への責任をもつ！！！(DevOpsの文脈に繋がる)
    - 一人に監視の全責任を押し付けるのは辞めましょう
- チェックボックス監視
    - チェックボックス監視：監視をしていますと言うためだけの監視は悪
    - 以下のような兆候がある場合は要注意
        - システム負荷などをメトリクスを記録しているがmシステムダウンしたことの理由はわからない
        - ご検知が多く、アラートを常に無視している
        - メトリクスの監視間隔が５分かそれ以上の間隔
        - メトリクスの履歴を保存していない
    - システムのことを理解せずに監視を設定すると陥りやすい
    - 直す方法
        - 「動いている」とはどう言う状態か。「動いていること」を監視する
        - アラートに関しては、OSのメトリクスはあまり意味がない
            - AuroraなどはCPU使用率が100%となっても、意外と性能が出たりする。CPU使用率のメトリクスを収集することに意味はあるが、アラートをあげて人を呼ぶ意味は薄い。
        - メトリクスを高頻度で収集する
            - 最低でも60秒に1回は欲しい
- 監視を支えにする
    - 何かが壊れたら都度それに関するアラートを追加して、アラートに寄りかかるのを辞めろということ
    - 問題は修正して、そもそも回復力のあるシステムにしよう
    - 監視だけ頑張ってもシステムは直らない
- 手動設定
    - 特にクラウド環境の場合、１つ１つのシステムを監視するのではなく複数にシステムをまとめて集合体として監視する。出ないと作業量が爆発する
    - 設定を追加するのではなく、勝手に登録されるようにしよう
    - 手動で行っているなら、自動化せよ

### 監視のデザインパターン(2章)

## リソース監視
CloudWatch Alarmで？

## ログ監視
CloudWatch logsにエラーだけ送ってもらい、通知する？

## 参考
- 入門監視　https://www.oreilly.co.jp/books/9784873118642/